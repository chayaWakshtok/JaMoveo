name: Azure Static Web Apps CI/CD

on:
  push:
    branches:
      - main
  pull_request:
    types: [opened, synchronize, reopened, closed]
    branches:
      - main

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Use Node.js 20
        uses: actions/setup-node@v3
        with:
          node-version: 20

      - name: Install dependencies and build
        run: |
          cd JaMoveoClient
          npm ci
          npm run build

      - name: Install latest Static Web Apps CLI
        run: npm install -g @azure/static-web-apps-cli@latest

      - name: Deploy to Azure Static Web Apps
        run: |
          npx swa deploy "/home/runner/work/JaMoveo/JaMoveo/JaMoveoClient/dist/JaMoveoClient/browser" \
            --app-name "JaMoveoClient" \
            --env "production" \
            --subscription-id "1bc832b1-6817-4ad5-94c1-1c8a7c07551d" \
            --deployment-token "bacb961d2a8b56d0a7b213cbb8b932f0b9c5def88f22ec83edd934c879d4b09401-89332315-69b5-4f38-9be6-42772c8b8fc40101912080b6e910"


